void function(e,t,n,r){var i=e.ES_ItemView=B.View.extend({constructor:function(){this.previewAnimIn=n.debounce(this.previewAnimIn,100),this.previewAnimOut=n.debounce(this.previewAnimOut,100),B.View.apply(this,arguments)},events:{"mousedown .item-content":"stopPropagation","dblclick .item-content *":"editContent","change .item-content":"stopPropagation","focus .item-content":"editContent","blur .item-content":"saveContent"},modelEvents:{remove:"remove","change:style.font.family":"loadFont","change:animation.in":"previewAnimIn","change:animation.out":"previewAnimOut"},bindings:[{type:"class",attr:{locked:"locked",hidden:"hidden",selected:"selected"}},{type:"style",attr:{visibility:"style.visible",zIndex:"index",left:"style.position.x",top:"style.position.y"},parse:function(e,t){switch(t){case"visibility":return e?"visible":"hidden";case"left":case"top":return e*100+"%";default:return e}}},{selector:".item-offset",type:"style",attr:{left:"style.offset.x",top:"style.offset.y",width:"style.width",height:"style.height"}},{selector:".item-container",type:"style",attr:{backgroundColor:"style.background.color",backgroundImage:"style.background.image.src",backgroundPosition:"style.background.position",backgroundRepeat:"style.background.repeat",backgroundSize:"style.background.size",borderWidth:"style.border.width",borderStyle:"style.border.style",borderColor:"style.border.color",borderRadius:"style.border.radius",boxShadow:"style.box_shadows"},parse:function(e,t,r){if(e)switch(t){case"backgroundImage":return e&&e!==" "?"url("+ES_App.getImageURL(e)+")":"url( )";case"boxShadow":var i="";return e&&n(e).each(function(t,n){i+=t.x+"px "+t.y+"px "+t.blur+"px "+t.color+(t.inset?" inset":"")+(n==e.length-1?"":", ")}),i;default:return e}}},{selector:".item-content",type:"style",attr:{color:"style.font.color",fontFamily:"style.font.family",fontSize:"style.font.size",fontWeight:"style.font.weight",fontStyle:"style.font.style",lineHeight:"style.line_height",letterSpacing:"style.letter_spacing",textDecoration:"style.text_decoration",paddingTop:"style.padding.top",paddingLeft:"style.padding.left",paddingRight:"style.padding.right",paddingBottom:"style.padding.bottom",textAlign:"style.align_h",textShadow:"style.text_shadows",alignItems:"style.flex.alignItems",alignContent:"style.flex.alignContent",justifyContent:"style.flex.justifyContent",flexDirection:"style.flex.direction",flexWrap:"style.flex.wrap",flexBasis:"style.flex.basis",flexGrow:"style.flex.grow"},parse:function(e,t){switch(t){case"fontSize":return e+"px";case"flexBasis":return e+"px";case"flexGrow":return e?"1":"0";case"textShadow":var r="";return e&&n(e).each(function(t,n){r+=t.x+"px "+t.y+"px "+t.blur+"px "+t.color+(n==e.length-1?"":", ")}),r;default:return e}}}],initialize:function(){this.model.itemView=this},ready:function(){this.sliderView=this.superView.superView,this.selectionsView=this.sliderView.selectionsView,this.$offset=this.$(".item-offset"),this.$content=this.$(".item-content"),this.$container=this.$(".item-container"),this.$animation=this.$(".item-animation"),this.medium=new Medium({element:this.$content.get(0),mode:Medium.richMode,autofocus:!1,autoHR:!1,maxLength:-1,modifiers:{b:"bold",i:"italicize",u:"underline",v:"paste"},cssClasses:{editor:"Medium",pasteHook:"Medium-paste-hook",placeholder:"Medium-placeholder",clear:"Medium-clear"},attributes:null,pasteAsText:!1,tags:{paragraph:"div",outerLevel:["a","div","li"],innerLevel:["b","u","i","img","strong","span","sup","sub"]}}),this.animation_in=ES_Timeline({align:"normal"}),this.animation_out=ES_Timeline({align:"normal "}),this.animation=ES_Timeline({align:"normal"}).add(this.animation_out).add(this.animation_in),this.listenTo(this.animation,"end",this.exitPreview),this.listenTo(this.animation_in,"end",this.exitPreview),this.listenTo(this.animation_out,"end",this.exitPreview),this.loadFont()},editContent:function(e){if(this.model.get("type")!=="text"||this._isEditing)return;this.rootView.$el.addClass("text-item-edit-mode"),this.model.selectionView.$el.addClass("edit-mode"),this.$el.addClass("edit-mode"),this.rootView.mediumToolbar.inspect(this.medium,e),this.rootView.itemInspector.close(),this.$el.siblings(".edit-mode").find(".item-content").trigger("blur"),this.medium.focus(),this._isEditing=!0},saveContent:function(e){this.$content.trigger("changecontent"),this.$content.hasClass("medium-toolbar-editing")||(this.rootView.$el.removeClass("text-item-edit-mode"),this.model.selectionView.$el.removeClass("edit-mode"),this.$el.removeClass("edit-mode"),this._isEditing=!1,this.rootView.mediumToolbar.release())},loadFont:function(){this.rootView.fontsLoader.load(this.model.get("style.font.family"))},enterPreview:function(){this.$container.removeClass("hidden"),this.$animation.html(this.$container.get(0).outerHTML),this.$container.addClass("hidden"),this.$animation.removeClass("hidden");var e=parseInt(this.model.root.get("layout.type")),t=parseInt(this.model.root.get("timeline.mode"));this.__dataBinding.updateView(),this.$animation=this.$(".item-animation").css("opacity",1);switch(parseInt(this.model.get("animation.in.split"))){case 1:this.$inElements=this.$animation.find(".item-content > *");break;case 2:this.$inElements=this.$animation.find(".split-word");break;case 3:this.$inElements=this.$animation.find(".split-char");break;default:this.$inElements=this.$animation}switch(parseInt(this.model.get("animation.out.split"))){case 1:this.$outElements=this.$animation.find(".item-content > *");break;case 2:this.$outElements=this.$animation.find(".split-word");break;case 3:this.$outElements=this.$animation.find(".split-char");break;default:this.$outElements=this.$animation}var n=this.model.get("animation.in").getTweenObj(),r=this.model.get("animation.out").getTweenObj();this.animation_out=ES_Timeline.staggerTo(this.$outElements,this.model.get("animation.out.splitDelay"),r,{paused:!0}),this.animation_in=ES_Timeline.staggerFrom(this.$inElements,this.model.get("animation.in.splitDelay"),n,{paused:!0}),this.animation=ES_Timeline({align:"normal",paused:!0}).add(this.animation_in).add(this.animation_out)},enterPreview2:function(){this.$container.removeClass("hidden"),this.$animation.html(this.$container.get(0).outerHTML),this.$container.addClass("hidden"),this.$animation.removeClass("hidden");switch(this.model.get("animation.in.split")){case"1":var e=this.$animation.find(".item-content > *");break;case"2":var e=this.$animation.find(".split-word");break;case"3":var e=this.$animation.find(".split-char");break;default:var e=this.$animation}this.animation_out.tweens=[],this.animation_in.tweens=[],this.animation_in.delay=this.model.get("animation.in.delay"),this.animation_in.duration=0,this.animation_in.tweens=ES_Timeline.staggerFrom(e,this.model.get("animation.in.splitDelay"),this.model.get("animation.in").getTweenObj()).tweens,this.animation_in.refreshDuration(),this.animation_out._render(0),this.animation_in._render(0)},exitPreview:function(){this.$animation.addClass("hidden"),this.$container.removeClass("hidden")},previewAnimIn:function(){this.rootView.enterAnimationPreview(),this.animation_in.tweens&&this.rootView.slideAnim.play(this.animation_in.tweens[0].delay)},previewAnimOut:function(){this.rootView.enterAnimationPreview(),this.animation_out.tweens&&this.rootView.slideAnim.play(this.animation_out.tweens[0].delay)}});e.ES_ItemsView=B.CollectionView.extend({itemView:i,constructor:function(){B.CollectionView.apply(this,arguments),this.activate()},activate:function(){this.activated=!0,this.$el.addClass("es-activated")},deactivate:function(){this.activated=!1,this.$el.removeClass("es-activated")}}),e.ES_GlobalItemsView=ES_ItemsView.extend({itemView:i.extend({constructor:function(){i.apply(this,arguments)}}),constructor:function(){ES_ItemsView.apply(this,arguments),this.deactivate()}})}(this,jQuery,_,JSNES_Backbone);
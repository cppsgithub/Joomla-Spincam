void function(e,t,n,r){e.ES_NavView=B.View.extend({events:{"mousedown .es-next":function(){this.rootView.slides.next().set("active",!0)},"mousedown .es-prev":function(){this.rootView.slides.prev().set("active",!0)}},ready:function(e){this.listenTo(this.model,"change",this.setStyle),this.listenTo(this.superView.model,"change:slides.active",this.setContent),this.delay(this.setStyle,25)},setStyle:function(){var e=this.model.get("enable");if(!e||this.rootView.model.get("slides").length==1)return this.$el.hide();var t=this.model.get("style"),n=ES_Nav.templates[t];this.$el.show(),this.$el.attr("class","es-nav es-nav-buttons es-nav-"+t),this.$(".es-next").html(n.next),this.$(".es-prev").html(n.prev),this.setContent()},setContent:function(){var e=this,n=this.rootView.slides.next(),r=this.rootView.slides.prev();(new Promise(function(i,s){var o=e.$(".es-next div").length?e.$(".es-next div"):e.$(".es-next"),u=o.width(),a=o.height();t.getImageThumb(n.get("background.image.src"),u,a,function(e){n.thumbSource=e,t.getImageThumb(r.get("background.image.src"),u,a,function(t){r.thumbSource=t,i(e,t)})})})).then(function(t,n){e.$(".es-next img").attr("src",t),e.$(".es-prev img").attr("src",n)}),this.$(".es-next .es-name").text(n.get("name")||""),this.$(".es-prev .es-name").text(r.get("name")||"")}}),e.ES_PaginationView=B.CollectionView.extend({modelEvents:{change:"change"},ready:function(){this.model||this.setModel(this.superView.model.get("pagination")),this.listenTo(this.collection,"add",this.reset),this.listenTo(this.collection,"sort",this.reset),this.listenTo(this.collection,"reset",this.reset),this.listenTo(this.collection,"remove",this.reset),this.delay(this.change,25)},change:function(){var e=this.model.get("enable");if(!e||this.rootView.model.get("slides").length==1)return this.$el.parent().hide();var t=this.style=this.model.get("style"),n=this.model.get("size")||"",r=this.model.get("spacing");this.$el.parent().show().attr("class","es-nav es-nav-pagination dotstyle dotstyle-"+t),this.$("li").width(n).height(n).css("margin","0 "+r/2+"px")},itemView:B.View.extend({events:{mousedown:function(e){this.model.set("active",!0)}},modelEvents:{change:"change","change:active":"setActive"},ready:function(){this.change(),this.setActive()},change:function(){this.$("a").text(this.model.get("name")||this.$el.index()+1)},setActive:function(){this.model.index()<this.superView.lastIndex?this.$el.attr("class","current-from-right"):this.$el.attr("class",""),this.delay(function(){this.model.get("active")?this.$el.addClass("current"):this.$el.removeClass("current"),this.superView.lastIndex=this.model.index()},25)}})}),e.ES_SelectionsView=B.CollectionView.extend({itemView:e.ES_SelectionView=B.View.extend({constructor:function(){B.View.apply(this,arguments)},events:{select:"select",deselect:"deselect",mousedown:"mousedown",dblclick:"dblclick",dragstart:"draggable_start",drag:"draggable_drag",dragstop:"draggable_stop",dragmultiple:"setPosition",resizestart:"resizable_start",resize:"resizable_resize",resizestop:"resizable_stop"},modelEvents:{remove:"remove","change:aspectRatio":"setAspectRatio"},bindings:[{type:"class",attr:{locked:"locked",selected:"selected",hidden:"hidden",visible:"style.visible"}},{type:"style",attr:{visibility:"style.visible",zIndex:"index",left:"style.position.x",top:"style.position.y"},parse:function(e,t){switch(t){case"visibility":return e?"visible":"hidden";case"left":case"top":return e*100+"%";default:return e}}},{selector:".selection-offset",type:"class",attr:{"ui-selected":"selected"}},{selector:".selection-offset",type:"style",attr:{left:"style.offset.x",top:"style.offset.y",width:"style.width",height:"style.height"}}],initialize:function(){this.model.selectionView=this},ready:function(){this.appView=this.superView.superView,this.itemsView=this.appView.itemsView,this.$offset=this.$(".selection-offset"),this.$offset.draggable({distance:5}),this.$offset.resizable({distance:5,handles:"all",aspectRatio:this.model.get("aspectRatio")})},select:function(){this.model.set("selected",!0)},deselect:function(){this.model.set("selected",!1)},mousedown:function(e){e.stopPropagation(),e.metaKey||e.ctrlKey?this.model.set("selected",!this.model.get("selected")):this.model.get("selected")||(this.model.set("selected",!0),n(this.model.collection.without(this.model)).invoke("set","selected",!1)),t("body").trigger(t.Event("mousedown",e))},dblclick:function(e){e.stopPropagation(),this.model.itemView.editContent(e)},setAspectRatio:function(){var e=n.extend(this.$offset.resizable("option"),{aspectRatio:this.model.get("aspectRatio")});this.$offset.resizable("destroy"),this.$offset.resizable(e)},setMinResizable:function(){this.model.itemView.setMinResizable()},getSize:function(){return n(window.getComputedStyle(this.$offset.get(0))).chain().pick("width","height").mapObject(function(e){return parseFloat(e)}).value()},saveSize:function(e,t){var n=t&&t.position?t.position:this.getPosition(),r=t&&t.size?t.size:this.getSize();return this.model.get("style").set({width:r.width,height:r.height,offset:{x:n.left,y:n.top}}),this},getPosition:function(){return n(window.getComputedStyle(this.$offset.get(0))).chain().pick("top","left").mapObject(function(e){return parseFloat(e)}).value()},setPosition:function(e,t){var r=1,i=this.model.root.get("grid");i.get("show")&&(r=parseInt(i.get("size"))/parseInt(i.get("gutter")));var s=this.$el.position();t.position&&(t.position.left=Math.floor((t.position.left+s.left)/r)*r-s.left,t.position.top=Math.floor((t.position.top+s.top)/r)*r-s.top,this.model.itemView.$offset.css(n.mapObject(t.position,function(e){return Math.round(e)}))),t.size&&(t.size.width=Math.ceil(t.size.width/r)*r,t.size.height=Math.ceil(t.size.height/r)*r,this.model.itemView.$offset.css(t.size))},getPosition:function(){},savePosition:function(e,t){this.model.get("style").set("offset",{x:t.position.left,y:t.position.top})},resizable_start:function(e,t){},resizable_resize:function(e,t){this.setPosition(e,t)},resizable_stop:function(e,t){this.saveSize(e,t)},draggable_start:function(e,t){this.$el.siblings(".selected").find(".selection-offset").addClass("ui-draggable-dragging"),this._position=t.position},draggable_drag:function(e,n){this.setPosition(e,n);var r=n.position.left-this._position.left,i=n.position.top-this._position.top;this._position=n.position,this.$el.siblings(".selected").find(".selection-offset").each(function(){var e=t(this).position();e.left+=r,e.top+=i,t(this).css(e).trigger("dragmultiple",{position:e})})},draggable_stop:function(e,t){this.$el.siblings(".selected").find(".selection-offset").removeClass("ui-draggable-dragging"),this.savePosition(e,t)}})})}(this,jQuery,_,JSNES_Backbone);